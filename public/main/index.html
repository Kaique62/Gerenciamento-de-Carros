<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GDV: Estoque</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../base.css">
</head>

<body class="bg-gray-100 font-sans">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <aside id="sidebar"
            class="w-64 flex flex-col bg-gray-800 text-gray-200 transition-all duration-300 ease-in-out shrink-0">
            <div class="logo-container flex items-center px-4 h-20 border-b border-gray-700 shrink-0">
                <i class="bi bi-car-front-fill"></i>
                <span class="sidebar-text ml-3 text-xl font-bold">Gerenciamento de Veiculos</span>
            </div>

            <nav class="flex-1 px-2 py-4 space-y-2">
                <a href="../main/index.html" id="nav-main"
                    class="nav-item flex items-center w-full p-3 rounded-lg hover:bg-gray-700">
                    <i class="bi bi-box-seam-fill"></i>
                    <span class="sidebar-text ml-4">Estoque</span>
                </a>
                <a href="../history/history.html" id="nav-history"
                    class="nav-item flex items-center w-full p-3 rounded-lg hover:bg-gray-700">
                    <i class="bi bi-clock-history"></i>
                    <span class="sidebar-text ml-4">Historico</span>
                </a>
                <a href="../analytics/analytics.html" id="nav-analytics"
                    class="nav-item flex items-center w-full p-3 rounded-lg hover:bg-gray-700">
                    <i class="bi bi-graph-up-arrow"></i>
                    <span class="sidebar-text ml-4">Relatórios</span>
                </a>
                <a href="../changes/changes.html" id="nav-analytics"
                    class="nav-item flex items-center w-full p-3 rounded-lg hover:bg-gray-700">
                    <i class="bi bi-arrow-repeat"></i>
                    <span class="sidebar-text ml-4">Mudanças</span>
                </a>
                <a href="../settings/settings.html" id="nav-settings"
                    class="nav-item flex items-center w-full p-3 rounded-lg hover:bg-gray-700">
                    <svg class="h-6 w-6 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span class="sidebar-text ml-4">Configurações</span>
                </a>
            </nav>

            <div class="p-2 border-t border-gray-700">
                <button id="toggle-sidebar-btn" class="flex items-center w-full p-3 rounded-lg hover:bg-gray-700">
                    <svg id="collapse-icon-svg" class="h-6 w-6 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"></svg>
                    <span class="sidebar-text ml-4">Recolher</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-6 sm:p-8 lg:p-10 overflow-y-auto">
            <header class="mb-8">
                <h1 class="text-4xl font-bold text-gray-800">Estoque de Carros</h1>
                <p class="text-gray-600 mt-2">Adicione, visualize, edite e remova seus veículos.</p>
            </header>

            <div
                class="flex flex-col sm:flex-row justify-between items-center gap-4 mb-6 p-3 rounded-lg bg-gray-800 text-white">
                <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4 w-full">

                    <div class="relative w-full sm:w-80">
                        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                            <i class="bi bi-search text-gray-400"></i>
                        </div>
                        <input type="search" id="search-input"
                            class="block w-full pl-10 pr-4 py-2 rounded-md bg-gray-700 border border-gray-600 placeholder-gray-400 text-white text-sm focus:ring-blue-500 focus:border-blue-500"
                            placeholder="Pesquisar por placa, modelo..." />
                    </div>

                    <div class="w-full sm:w-56">
                        <select id="filter-select"
                            class="block w-full py-2 px-3 rounded-md bg-gray-700 border border-gray-600 text-white text-sm focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Todos os Status</option>
                            <option value="available">Disponíveis</option>
                            <option value="sold">Vendidos</option>
                            <!-- Apenas durante a fase de prototipagem!  <option value="maintenance">Em Manutenção</option> -->
                        </select>
                    </div>

                </div>

                <div class="flex flex-col sm:flex-row items-center gap-4 w-full sm:w-auto mt-4 sm:mt-0">
                    <div class="flex items-center w-full sm:w-auto">
                        <input type="text" id="plate-search"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-l-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 rounded-r-none w-full"
                            placeholder="Placa..." />
                        <button type="submit" id="edit-by-plate-button"
                            class="inline-flex items-center py-2.5 px-3 text-sm font-medium text-white bg-blue-700 rounded-r-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 rounded-l-none">
                            Editar
                        </button>
                    </div>

                    <div class="flex items-center w-full sm:w-auto">
                        <button id="open-add-modal-button" type="button"
                            class="inline-flex items-center justify-center gap-2 text-white bg-green-600 hover:bg-green-700 font-medium rounded-lg text-sm px-5 py-2.5 w-full">
                            <i class="bi bi-plus-circle-fill"></i>
                            Adicionar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Cars Grid -->
            <div id="car-grid-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Cards de carros serão inseridos aqui pelo JavaScript -->
            </div>
        </main>
    </div>

    <!-- modal: vizualizar informações do carro-->
    <div id="details-modal" class="hidden fixed inset-0 z-50 bg-gray-900 bg-opacity-75 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="modal-panel bg-white rounded-lg w-full max-w-4xl shadow-xl relative">
                <!-- Header -->
                <div class="flex items-start justify-between p-5 border-b rounded-t">
                    <h3 id="details-modal-title" class="text-2xl font-bold text-gray-900"></h3>
                    <button type="button" class="js-close-modal text-gray-400 hover:text-gray-900 text-2xl">×</button>
                </div>
                <!-- Body -->
                <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div id="my-carousel-container" class="w-full max-w-xl mx-auto"></div>
                    <div class="space-y-4">
                        <div>
                            <h4 class="text-lg font-bold text-gray-800">Preço</h4>
                            <p id="details-modal-price" class="text-3xl font-bold text-green-600"></p>
                        </div>
                        <div class="border-t pt-4">
                            <h4 class="text-lg font-bold text-gray-800 mb-2">Especificações</h4>
                            <dl id="details-modal-specs" class="space-y-2 text-gray-700"></dl>
                        </div>
                    </div>
                </div>
                <!-- Footer -->
                <div class="flex items-center justify-end p-5 gap-3 border-t rounded-b">
                    <button type="button"
                        class="js-close-modal px-6 py-2 rounded-lg border bg-white text-gray-700 hover:bg-gray-100">Fechar</button>
                    <button id="details-sell-button" type="button" data-plate=""
                        class="px-6 py-2 rounded-lg bg-green-600 text-white font-semibold hover:bg-green-700">
                        <i class="bi bi-currency-dollar"></i> Vender
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- modal: adicionar carro-->
    <div id="add-modal" class="hidden fixed inset-0 z-50 bg-gray-900 bg-opacity-75 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <form id="add-car-form"
                class="modal-panel bg-gray-50 rounded-2xl w-full max-w-6xl shadow-2xl relative border border-gray-300">
                <div class="flex items-start justify-between p-6 border-b">
                    <h2 class="text-3xl font-bold text-gray-800">Adicionar Novo Veículo</h2>
                    <button type="button" class="js-close-modal text-gray-400 hover:text-red-600 text-3xl">×</button>
                </div>
                <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-6 max-h-[70vh] overflow-y-auto">
                    <!-- Coluna de Imagens -->
                    <div class="flex flex-col gap-1">
                        <!-- Container para a imagem principal -->
                        <div>
                            <label class="block mb-2 text-sm font-medium text-gray-700">Imagem Principal *</label>
                            <label
                                class="relative aspect-video bg-gray-200 border-2 border-dashed rounded-xl flex items-center justify-center cursor-pointer hover:border-blue-500">
                                <input type="file" name="mainImage" accept="image/*"
                                    class="absolute inset-0 opacity-0 cursor-pointer">
                                <img class="mainImagePreview w-full h-full object-cover hidden rounded-xl" />
                                <span class="mainImageIcon text-6xl text-gray-400 font-light">+</span>
                            </label>
                        </div>

                        <!-- Container para as imagens adicionais -->
                        <div>
                            <label class="block mb-2 text-sm font-medium text-gray-700">Imagens Adicionais <strong
                                    id="extraIamgeCouter">0/5</strong></label>

                            <!-- Container onde as pré-visualizações e o botão de upload serão renderizados -->
                            <div id="additional-image-container"
                                class="grid grid-cols-3 sm:grid-cols-3 md:grid-cols-3 gap-2">

                                <!-- O botão de upload inicial será controlado pelo JavaScript -->
                                <label
                                    class="relative aspect-square bg-gray-200 border-2 border-dashed rounded-xl flex items-center justify-center cursor-pointer hover:border-blue-300 transition-colors">
                                    <input type="file" id="additional-images-input" accept="image/*" multiple
                                        class="absolute inset-0 opacity-0 w-full h-full cursor-pointer">
                                    <span class="text-4xl text-gray-400 font-light"><i
                                            class="bi bi-plus-circle"></i></span>
                                </label>

                            </div>
                        </div>

                        <!-- Div para exclusão do carro -->
                        <div id="delete-car-div"
                            class="flex flex-col gap-2 rounded-lg bg-red-500 p-3 mt-5 border border-red-700">

                            <label class="block text-lg font-semibold text-white">Excluir Carro Permanentemente</label>

                            <input placeholder="Escreva 'Excluir' para excluir"
                                class="w-full rounded-lg px-4 py-2 bg-red-50 border border-red-200 text-red-900 placeholder-red-400 focus:outline-none focus:ring-2 focus:ring-white"
                                id="ExcluirInput" />

                            <button type="button"
                                class="px-4 py-2 rounded-lg bg-red-800 text-white font-semibold hover:bg-black hover:bg-opacity-20 transition-all focus:outline-none focus:ring-2 focus:ring-white"
                                id="removeConfirm">
                                Confirmar Exclusão
                            </button>
                        </div>
                    </div>
                    <!-- Coluna de Campos -->
                    <div class="md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-5">
                        <div>
                            <label for="add-name" class="block mb-1 text-sm font-medium text-gray-700">Nome / Modelo
                                *</label>
                            <input type="text" id="add-name" name="name" placeholder="Ex: Honda Civic"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                required />
                        </div>
                        <div>
                            <label for="add-license_plate" class="block mb-1 text-sm font-medium text-gray-700">Placa
                                *</label>
                            <input type="text" id="add-license_plate" name="license_plate" placeholder="Ex: ABC-1234"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                required />
                        </div>
                        <div>
                            <label for="add-year" class="block mb-1 text-sm font-medium text-gray-700">Ano /
                                Modelo</label>
                            <input type="text" id="add-year" name="year" placeholder="Ex: 2020/2021"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        </div>
                        <div>
                            <label for="add-price" class="block mb-1 text-sm font-medium text-gray-700">Preço (R$)
                                *</label>
                            <input type="number" id="add-price" name="price" placeholder="Ex: 75000.00"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                step="0.01" required />
                        </div>
                        <div>
                            <label for="add-mileage" class="block mb-1 text-sm font-medium text-gray-700">Quilometragem
                                (KM) *</label>
                            <input type="number" id="add-mileage" name="mileage" placeholder="Ex: 45000"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
                                required />
                        </div>
                        <div>
                            <label for="add-chassis" class="block mb-1 text-sm font-medium text-gray-700">Chassi</label>
                            <input type="text" id="add-chassis" name="chassis" placeholder="Ex: 9BWZZZ377VT004251"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        </div>
                        <div>
                            <label for="add-registration_number"
                                class="block mb-1 text-sm font-medium text-gray-700">RENAVAM</label>
                            <input type="number" id="add-registration_number" name="registration_number"
                                placeholder="Número do RENAVAM"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        </div>
                        <div>
                            <label for="add-ownership_document" class="block mb-1 text-sm font-medium text-gray-700">CRV
                                / ATPV-e</label>
                            <input type="number" id="add-ownership_document" name="ownership_document"
                                placeholder="Número do documento"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        </div>
                        <div class="sm:col-span-2">
                            <label for="add-ipva_tax_years" class="block mb-1 text-sm font-medium text-gray-700">Anos de
                                IPVA Pago</label>
                            <input type="text" id="add-ipva_tax_years" name="ipva_tax_years"
                                placeholder="Ex: 2022, 2023, 2024"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        </div>
                        <div class="sm:col-span-2">
                            <label for="add-description"
                                class="block mb-1 text-sm font-medium text-gray-700">Descrição</label>
                            <textarea id="add-description" name="description"
                                placeholder="Detalhes sobre o veículo, opcionais, estado de conservação..." rows="3"
                                class="w-full rounded-lg px-4 py-2 bg-white border border-gray-300 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                    </div>
                </div>
                <div class="flex justify-end gap-3 p-6 border-t bg-gray-50 rounded-b-2xl">
                    <button type="button"
                        class="js-close-modal px-6 py-2 rounded-lg border bg-white text-gray-700 hover:bg-gray-100">Cancelar</button>
                    <button type="submit"
                        class="px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700">Salvar
                        Veículo</button>
                </div>
            </form>
        </div>
    </div>

    <!-- modal: registrar venda -->
    <div id="sell-modal" class="hidden fixed inset-0 z-50 bg-gray-900 bg-opacity-75 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">

            <form id="sell-car-form"
                class="modal-panel bg-white rounded-2xl w-full max-w-lg shadow-2xl relative border border-gray-200">

                <!-- Cabeçalho do Modal -->
                <div class="flex items-start justify-between p-6 border-b">
                    <div>
                        <h2 class="text-3xl font-bold text-gray-800">Registrar Venda</h2>
                        <p class="text-gray-600 mt-1">Confirme os detalhes da transação.</p>
                    </div>
                    <button type="button" class="js-close-modal text-gray-400 hover:text-red-600 text-3xl">×</button>
                </div>

                <!-- Corpo do Modal -->
                <div class="p-6 space-y-6">
                    <!-- Informações do Veículo (serão preenchidas por JS) -->
                    <div class="bg-gray-100 p-4 rounded-lg border">
                        <h3 id="sell-modal-car-name" class="font-bold text-lg text-gray-900">Nome do Veículo Aqui</h3>
                        <p class="text-sm text-gray-500">Placa:
                            <span id="sell-modal-car-plate" class="font-mono font-semibold">ABC-1234</span>
                        </p>
                    </div>

                    <!-- Campos do Formulário -->
                    <div class="grid grid-cols-1 gap-5">
                        <!-- Campo oculto para enviar a placa com o formulário -->
                        <input type="hidden" id="sell-modal-hidden-plate" name="car_license_plate" />

                        <div>
                            <label for="sale_value" class="block text-sm font-medium text-gray-700 mb-1">Valor da Venda
                                (R$)</label>
                            <input type="number" name="sale_value" id="sale_value" placeholder="Ex: 55000.00"
                                step="0.01"
                                class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                                required />
                        </div>

                        <div>
                            <label for="sale_date" class="block text-sm font-medium text-gray-700 mb-1">Data da
                                Venda</label>
                            <input type="date" name="sale_date" id="sale_date"
                                class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                                required />
                        </div>

                        <div>
                            <label for="payment_method" class="block text-sm font-medium text-gray-700 mb-1">Forma de
                                Pagamento</label>
                            <select name="payment_method" id="payment_method"
                                class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                                required>
                                <option>À Vista (Pix/TED)</option>
                                <option>Financiamento</option>
                                <option>Troca</option>
                                <option>Consórcio</option>
                                <option>Outro</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Rodapé com Botões -->
                <div class="flex justify-end gap-3 p-6 border-t bg-gray-50 rounded-b-2xl">
                    <button type="button"
                        class="js-close-modal px-6 py-2 rounded-lg border bg-white text-gray-700 hover:bg-gray-100">Cancelar</button>
                    <button type="submit"
                        class="px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700">Confirmar
                        Venda</button>
                </div>
            </form>

        </div>
    </div>

    <script src="../dashboard.js"></script>
    <script src="/main/script.js"></script>
</body>

</html>